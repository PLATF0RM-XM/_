<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>XM Admin Ultra</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body{margin:0;font-family:Arial;background:#07162e;color:#fff}
header{padding:20px;text-align:center;font-size:22px;background:linear-gradient(135deg,#0b2a52,#07162e)}
.stats{display:flex;gap:10px;justify-content:center;flex-wrap:wrap}
.stat{background:rgba(255,255,255,.1);padding:15px;border-radius:14px;width:150px;text-align:center}
.box{max-width:1100px;margin:20px auto;background:rgba(255,255,255,.08);padding:20px;border-radius:16px}
input,select,button{width:100%;padding:12px;margin:6px 0;border-radius:8px;border:none}
button{background:#00c176;font-weight:bold}
table{width:100%;margin-top:20px;border-collapse:collapse}
td,th{padding:10px;border-bottom:1px solid rgba(255,255,255,.2);text-align:center}
.lock{color:#f00;font-weight:bold}
</style>
</head>
<body>

<header>XM Admin Ultra Panel</header>

<div class="stats">
 <div class="stat"><h2 id="acc">0</h2><p>Accounts</p></div>
 <div class="stat"><h2 id="tr">0</h2><p>Trades</p></div>
 <div class="stat"><h2 id="pf">0</h2><p>Profit</p></div>
</div>

<div class="box" id="login">
 <input id="email" placeholder="Email">
 <input id="password" type="password" placeholder="Password">
 <button onclick="login()">Login</button>
</div>

<div class="box" id="panel" style="display:none">
<h3>Ø¥Ø¶Ø§ÙØ© ØµÙÙ‚Ø©</h3>
<input id="tx" placeholder="Ø±Ù‚Ù… Ø§Ù„ØµÙÙ‚Ø©">
<input id="name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±">
<input id="amount" placeholder="Ù…Ø¨Ù„Øº Ø§Ù„ØµÙÙ‚Ø©">
<input id="fees" placeholder="Ø§Ù„Ø±Ø³ÙˆÙ…">
<button onclick="addDeal()">Ø­ÙØ¸ Ø§Ù„ØµÙÙ‚Ø©</button>

<h3>Ø§Ù„ØµÙÙ‚Ø§Øª</h3>
<table>
<thead><tr><th>Ø±Ù‚Ù…</th><th>Ø§Ø³Ù…</th><th>Ù…Ø¨Ù„Øº</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th><th>Ù‚ÙÙ„</th></tr></thead>
<tbody id="rows"></tbody>
</table>
</div>

<script>
const firebaseConfig={
 apiKey:"AIzaSyDCVCtl1ca3NSoy6tAWCp-ykgGBa21ZNp8",
 authDomain:"investment-platform-b419d.firebaseapp.com",
 projectId:"investment-platform-b419d"
};
firebase.initializeApp(firebaseConfig);

const auth=firebase.auth(),db=firebase.firestore();
let role="staff";

function animate(id,to){
 let v=0;const i=setInterval(()=>{v+=Math.ceil(to/50);if(v>=to){v=to;clearInterval(i)}document.getElementById(id).innerText=v},30)
}
animate("acc",128734);animate("tr",452198);animate("pf",984321);

function login(){
 auth.signInWithEmailAndPassword(email.value,password.value)
 .then(u=>{
  db.collection("admins").doc(u.user.uid).get().then(d=>{
   role=d.exists?d.data().role:"staff";
   login.style.display="none";
   panel.style.display="block";
   load();
  })
 })
 .catch(e=>alert(e.message));
}

function addDeal(){
 if(role!=="super"){alert("ØºÙŠØ± Ù…Ø³Ù…ÙˆØ­");return;}
 db.collection("transactions").doc(tx.value).set({
  name:name.value,amount:amount.value,fees:fees.value,status:"ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø³Ø¯Ø§Ø¯",locked:false
 });
}

function load(){
 db.collection("transactions").onSnapshot(s=>{
 let h="";
 s.forEach(d=>{
  const x=d.data();
  h+=`<tr>
   <td>${d.id}</td>
   <td>${x.name}</td>
   <td>${x.amount}</td>
   <td>${x.status}</td>
   <td>${x.locked?"ğŸ”’":"<button onclick=lockDeal('"+d.id+"')>Ù‚ÙÙ„</button>"}</td>
  </tr>`;
 });
 rows.innerHTML=h;
 });
}

function lockDeal(id){
 db.collection("transactions").doc(id).update({locked:true,status:"Ù…ØºÙ„Ù‚Ø©"});
}
</script>

</body>
</html>
