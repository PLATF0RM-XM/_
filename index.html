<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Investment Platform</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>

<style>
body{margin:0;font-family:system-ui;background:#0f1f3e;color:#eaf0ff}
header{background:linear-gradient(135deg,#0b1833,#132a5a);padding:16px;text-align:center;position:relative}
.lang{position:absolute;top:12px;left:12px}
.card{background:#1c2d52;border-radius:16px;padding:22px;margin:20px}
input,button,select{width:100%;padding:14px;border-radius:10px;border:none;margin-top:10px}
button{background:#00b05c;color:#fff;font-weight:bold}
.status{padding:10px;border-radius:10px;text-align:center;font-weight:bold;margin-top:10px}
.Pending{background:#3a2f1d;color:#ffd27d}
.Paid{background:#1d3a2a;color:#7dffb2}
.Rejected{background:#3a1d1d;color:#ff7d7d}
footer{text-align:center;color:#9fb0d1;font-size:11px;padding:20px}
</style>
</head>

<body>

<header>
  <div class="lang">
    <select onchange="setLang(this.value)">
      <option value="ar">AR</option>
      <option value="en">EN</option>
    </select>
  </div>
  <div id="title" style="font-size:20px;font-weight:700;color:#00b05c"></div>
  <div id="subtitle" style="font-size:12px;color:#9fb0d1"></div>
</header>
<style>
.xm-banner{
  width:100%;
  max-width:100%;
  height:220px;
  background:linear-gradient(120deg,#0b1833,#132a5a,#0b1833);
  display:flex;
  align-items:center;
  justify-content:center;
  overflow:hidden;
  position:relative;
}
.xm-banner img{
  max-width:55%;
  animation:float 6s ease-in-out infinite;
}
@keyframes float{
  0%{transform:translateY(0)}
  50%{transform:translateY(-10px)}
  100%{transform:translateY(0)}
}
@media(max-width:600px){
  .xm-banner{height:170px}
  .xm-banner img{max-width:75%}
}
</style>

<div class="xm-banner">
  <img src="IMG_7211.webp" alt="Investment Platforms">
</div>


<div style="text-align:center;margin:20px">
  <img src="IMG_7211.webp" style="max-width:60%;margin:20px auto;display:block">
</div>



<div class="card">
  <input id="dealInput">
  <button onclick="loadDeal()" id="trackBtn"></button>
</div>

<div class="card" id="details" style="display:none">
  <p><b id="lblName"></b> <span id="name"></span></p>
  <p><b id="lblInv"></b> <span id="investment"></span></p>
  <p><b id="lblProfit"></b> <span id="profit"></span></p>
  <p><b id="lblReceipt"></b> <span id="receipt"></span></p>
  <div id="statusBox" class="status"></div>
</div>

<div class="card" id="payment" style="display:none">
  <p id="vodafoneText"></p>
  <input type="file" id="proof" accept="image/*">
  <button onclick="uploadProof()" id="payBtn"></button>
</div>

<footer id="footer"></footer>
<div class="card" id="smartPay" style="display:none">
  <p id="feeText"></p>
  <button id="payNowBtn" onclick="openPay()">سدد الآن</button>
</div>

<script>
function openPay(){
 const amount = window.currentFee || "";
 const msg = localStorage.lang==="en"
  ? "Payment initiated for trade "+currentDeal+" | Fees: "+amount
  : "تم بدء عملية السداد للصفقة رقم "+currentDeal+" | الرسوم: "+amount;

 window.open("https://wa.me/201234567890?text="+encodeURIComponent(msg),"_blank");
}
</script>

<style>
.fade-in{animation:fadeUp 1.2s ease forwards}
@keyframes fadeUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
.xm-banner{background-attachment:fixed}
.stats{display:flex;justify-content:space-around;text-align:center;margin:30px 15px}
.stat{background:#1c2d52;padding:20px;border-radius:16px;width:30%}
.stat h2{color:#00b05c;font-size:28px}
@media(max-width:600px){.stats{flex-direction:column}.stat{width:100%;margin-bottom:15px}}
</style>

<div class="stats fade-in">
 <div class="stat"><h2 id="acc">0</h2><div>Accounts</div></div>
 <div class="stat"><h2 id="trades">0</h2><div>Trades</div></div>
 <div class="stat"><h2 id="profit">0</h2><div>Profit</div></div>
</div>

<script>
function counter(id,target){
 let c=0,el=document.getElementById(id);
 const i=setInterval(()=>{
  c+=Math.ceil(target/60);
  if(c>=target){c=target;clearInterval(i);}
  el.innerText=c.toLocaleString();
 },30);
}
window.addEventListener("load",()=>{
 counter("acc",12480);
 counter("trades",58234);
 counter("profit",937000);
});
</script>


<script>
const text={
 ar:{
  dir:"rtl",
  title:"منصة الاستثمار",
  subtitle:"متابعة الصفقات وحالة السداد",
  deal:"رقم الصفقة",
  track:"متابعة الصفقة",
  name:"اسم المستثمر:",
  inv:"مبلغ الاستثمار:",
  profit:"الأرباح:",
  receipt:"رقم الاستلام:",
  vodafone:"فودافون كاش: 01012345678",
  pay:"إرسال إثبات التحويل",
  footer:"هذه المنصة مخصصة لعرض حالة الصفقات فقط",
  wa:"تم إرسال إثبات التحويل للصفقة رقم "
 },
 en:{
  dir:"ltr",
  title:"Investment Platform",
  subtitle:"Trade Tracking & Payment Status",
  deal:"Trade Number",
  track:"Track Trade",
  name:"Investor:",
  inv:"Investment:",
  profit:"Profit:",
  receipt:"Receipt No:",
  vodafone:"Vodafone Cash: 01012345678",
  pay:"Submit Payment Proof",
  footer:"This platform is for trade tracking and status display only",
  wa:"Payment proof submitted for trade "
 }
};

function setLang(l){
 localStorage.lang=l;
 document.documentElement.lang=l;
 document.documentElement.dir=text[l].dir;
 title.innerText=text[l].title;
 subtitle.innerText=text[l].subtitle;
 dealInput.placeholder=text[l].deal;
 trackBtn.innerText=text[l].track;
 lblName.innerText=text[l].name;
 lblInv.innerText=text[l].inv;
 lblProfit.innerText=text[l].profit;
 lblReceipt.innerText=text[l].receipt;
 vodafoneText.innerText=text[l].vodafone;
 payBtn.innerText=text[l].pay;
 footer.innerText=text[l].footer;
}

const autoLang = localStorage.lang || (navigator.language.startsWith("en") ? "en" : "ar");
setLang(autoLang);

const firebaseConfig={
 apiKey:"AIzaSyDCVCtl1ca3NSoy6tAWCp-ykgGBa21ZNp8",
 authDomain:"investment-platform-b419d.firebaseapp.com",
 projectId:"investment-platform-b419d",
 storageBucket:"investment-platform-b419d.firebasestorage.app",
 messagingSenderId:"831226258536",
 appId:"1:831226258536:web:6aae445cb9d33d06cd07dd",
 measurementId:"G-BVHHWWF7DL"
};

firebase.initializeApp(firebaseConfig);

const db=firebase.firestore();
const storage=firebase.storage();
let currentDeal="";

async function loadDeal(){
 const id=dealInput.value.trim();
 const doc=await db.collection("deals").doc(id).get();
 if(!doc.exists){alert("Not found");return;}
 const d=doc.data();
 currentDeal=id;
 details.style.display="block";
 payment.style.display="block";
 name.innerText=d.name;
 investment.innerText=d.investment;
 profit.innerText=d.profit;
 receipt.innerText=d.receipt;
 statusBox.innerText=d.status;
 statusBox.className="status "+d.status;
 if(d.status!=="Paid"){
   document.getElementById("smartPay").style.display="block";
   window.currentFee = d.fee || "—";
   document.getElementById("feeText").innerText =
     (localStorage.lang==="en"
      ? "Required Fees: "
      : "الرسوم المطلوبة: ") + window.currentFee;
 }

}

async function uploadProof(){
 const file=proof.files[0];
 if(!file)return;
 await storage.ref("proofs/"+currentDeal+".jpg").put(file);
 await db.collection("deals").doc(currentDeal).update({status:"Pending"});
 const l=localStorage.lang||"ar";
 // Notify client
 window.open("https://wa.me/201234567890?text="+text[l].wa+currentDeal,"_blank");

 // Notify admin automatically
 const adminMsg = l==="en"
  ? "New payment proof uploaded for trade "+currentDeal
  : "تم رفع إثبات تحويل جديد للصفقة رقم "+currentDeal;

 window.open("https://wa.me/201111111111?text="+encodeURIComponent(adminMsg),"_blank");

}
</script>

<style>
/* Loading Screen */
#loader{
 position:fixed;inset:0;
 background:#0b1833;
 display:flex;align-items:center;justify-content:center;
 z-index:9999;
}
.loader-box{
 width:60px;height:60px;
 border:4px solid rgba(255,255,255,.2);
 border-top:4px solid #00b05c;
 border-radius:50%;
 animation:spin 1s linear infinite;
}
@keyframes spin{to{transform:rotate(360deg)}}

/* Glassmorphism cards */
.card,.stat{
 backdrop-filter:blur(14px);
 background:rgba(28,45,82,0.6);
 box-shadow:0 8px 32px rgba(0,0,0,.25);
 border:1px solid rgba(255,255,255,.08);
}

/* Mobile touch effect */
button:active,.stat:active{
 transform:scale(.97);
 opacity:.9;
}
</style>

<div id="loader">
 <div class="loader-box"></div>
</div>

<script>
window.addEventListener("load",()=>{
 setTimeout(()=>document.getElementById("loader").style.display="none",800);
});
</script>
</body>
</html>
