<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>سداد الرسوم | منصة XM</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>

<style>
body{
 margin:0;
 font-family:Arial;
 background:linear-gradient(135deg,#07162e,#0b2a52);
 color:#fff;
 text-align:center;
}
.container{
 max-width:420px;
 margin:80px auto;
 background:rgba(255,255,255,.12);
 backdrop-filter:blur(16px);
 border-radius:18px;
 padding:25px;
}
h2{margin-bottom:10px}
.vc{
 background:#000;
 padding:12px;
 border-radius:10px;
 margin:15px 0;
 font-size:18px;
}
input[type=file]{
 width:100%;
 margin:10px 0;
}
button{
 width:100%;
 padding:14px;
 border:none;
 border-radius:12px;
 background:#00c176;
 font-weight:bold;
 font-size:16px;
 cursor:pointer;
}
.note{
 font-size:13px;
 opacity:.8;
 margin-top:10px;
}
</style>
</head>
<body>

<div class="container">
 <h2>سداد رسوم الصفقة</h2>
 <p>يرجى تحويل الرسوم على رقم فودافون كاش:</p>
 <div class="vc">010XXXXXXXX</div>

 <input type="file" id="proof" accept="image/*">
 <button onclick="upload()">إرسال إثبات التحويل</button>

 <div class="note">سيتم مراجعة التحويل من الإدارة</div>
</div>

<script>
const firebaseConfig = {
 apiKey: "AIzaSyDCVCtl1ca3NSoy6tAWCp-ykgGBa21ZNp8",
 authDomain: "investment-platform-b419d.firebaseapp.com",
 projectId: "investment-platform-b419d",
 storageBucket: "investment-platform-b419d.firebasestorage.app"
};
firebase.initializeApp(firebaseConfig);

const db = firebase.firestore();
const storage = firebase.storage();

const tx = new URLSearchParams(window.location.search).get("tx");

function upload(){
 const file = proof.files[0];
 if(!file){alert("يرجى اختيار صورة");return;}

 const ref = storage.ref("payments/"+tx+".jpg");
 ref.put(file)
 .then(()=>ref.getDownloadURL())
 .then(url=>{
   db.collection("transactions").doc(tx).update({
     paymentProof:url,
     status:"تم إرسال الإثبات"
   }).then(()=>{
     alert("تم إرسال إثبات التحويل بنجاح");
   });
 })
 .catch(err=>alert(err.message));
}
</script>

</body>
</html>
